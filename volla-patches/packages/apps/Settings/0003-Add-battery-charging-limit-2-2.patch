From a9fdfca43841fb3dc54f6ece9ec5d157f633465c Mon Sep 17 00:00:00 2001
From: Your Name <you@example.com>
Date: Wed, 28 Sep 2022 08:53:11 +0200
Subject: [PATCH 3/4] Add battery charging limit [2/2]

Change-Id: Ic99d985c3b93a8b1c72e81df2f631e62ddc2d07a
---
 res/values/cm_arrays.xml        | 10 ++++++++++
 res/values/cm_strings.xml       |  2 ++
 res/xml/power_usage_summary.xml |  7 +++++++
 3 files changed, 19 insertions(+)

diff --git a/res/values/cm_arrays.xml b/res/values/cm_arrays.xml
index 32c93ce47f..3481891487 100644
--- a/res/values/cm_arrays.xml
+++ b/res/values/cm_arrays.xml
@@ -36,4 +36,14 @@
         <item>900000</item>
         <item>1800000</item>
     </string-array>
+
+    <string-array name="battery_charging_limit_entries" translatable="false">
+        <item>100</item>
+        <item>95</item>
+        <item>90</item>
+        <item>85</item>
+        <item>80</item>
+        <item>75</item>
+    </string-array>
+
 </resources>
diff --git a/res/values/cm_strings.xml b/res/values/cm_strings.xml
index df7c7b4260..98ac9da30b 100644
--- a/res/values/cm_strings.xml
+++ b/res/values/cm_strings.xml
@@ -203,4 +203,6 @@
 
     <!-- Legal -->
     <string name="lineage_legal_url">https://lineageos.org/legal</string>
+
+    <string name="battery_charging_limit_title">Charging limit value</string>
 </resources>
diff --git a/res/xml/power_usage_summary.xml b/res/xml/power_usage_summary.xml
index 577720348d..530145c236 100644
--- a/res/xml/power_usage_summary.xml
+++ b/res/xml/power_usage_summary.xml
@@ -65,6 +65,13 @@
         lineage:requiresConfig="@*lineageos.platform:integer/config_deviceLightCapabilities"
         lineage:requiresConfigMask="64" />
 
+    <lineageos.preference.SystemSettingListPreference
+        android:key="battery_charging_limit"
+        android:title="@string/battery_charging_limit_title"
+        android:entries="@array/battery_charging_limit_entries"
+        android:entryValues="@array/battery_charging_limit_entries"
+        android:defaultValue="100" />
+
     <SwitchPreference
         android:key="battery_percentage"
         android:title="@string/battery_percentage"
-- 
2.29.2

